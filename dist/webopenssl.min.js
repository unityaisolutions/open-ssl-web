;(function(root,factory){if(typeof module==="object"&&module.exports){module.exports=factory()}else if(typeof define==="function"&&define.amd){define([],factory)}else{root.WebOpenSSL=factory()}})(typeof self!=="undefined"?self:this,function(){"use strict";var p=d();function n(){return typeof process!=="undefined"&&process.versions&&process.versions.node}function a(){try{return typeof require==="function"}catch(e){return false}}function d(){if(n()&&a()){try{var c=require("crypto");return{name:"nodecrypto",randBytes:function(l){var b=c.randomBytes(l);return new Uint8Array(b.buffer,b.byteOffset||0,b.length)}}}catch(e){}}if(typeof globalThis!=="undefined"&&globalThis.crypto&&typeof globalThis.crypto.getRandomValues==="function"){return{name:"webcrypto",randBytes:function(l){if(!Number.isInteger(l)||l<=0)throw new Error("length must be a positive integer");var a=new Uint8Array(l);globalThis.crypto.getRandomValues(a);return a}}}throw new Error("No secure random provider available")}function s(t){if(!t||typeof t.randBytes!=="function")throw new Error("Invalid provider");p=t}function o(){return p&&p.name||"unknown"}function i(l){if(!Number.isInteger(l)||l<=0)throw new Error("length must be a positive integer");return p.randBytes(l)}function u(y){if(typeof Buffer!=="undefined"&&typeof Buffer.from==="function")return Buffer.from(y).toString("base64");var b="",k=32768;for(var i2=0;i2<y.length;i2+=k){b+=String.fromCharCode.apply(null,y.subarray(i2,i2+k))}return btoa(b)}function m(y){var s2="",i2,y2=y.length,h;for(i2=0;i2<y2;i2++){h=y[i2].toString(16);if(h.length<2)h="0"+h;s2+=h}return s2}function e(l){return u(i(l))}function v(l){return m(i(l))}function w(Module){if(!Module||!Module.cwrap||!Module._malloc||!Module._free||!Module.HEAPU8)throw new Error("Invalid OpenSSL WASM Module");var randFn=null;try{randFn=Module.cwrap("openssl_rand_bytes","number",["number","number"])}catch(_){ }if(!randFn){try{randFn=Module.cwrap("RAND_bytes","number",["number","number"])}catch(_){ }}if(!randFn)throw new Error("Missing RAND function");return{name:"openssl-wasm",randBytes:function(length){if(!Number.isInteger(length)||length<=0)throw new Error("length must be a positive integer");var ptr=Module._malloc(length);var ret=randFn(ptr,length);if(ret!==1){Module._free(ptr);throw new Error("RAND failed")}var out=new Uint8Array(length);out.set(Module.HEAPU8.subarray(ptr,ptr+length));Module._free(ptr);return out}}}function g(Module){s(w(Module))}function h(opts){opts=opts||{};var url=opts.url||"./dist/openssl-wasm/openssl_module.js";var name=opts.factoryGlobalName||"OpenSSLModuleFactory";function loadScript(u){return new Promise(function(resolve,reject){if(typeof document==="undefined")return reject(new Error("Script loader only available in browsers"));var sc=document.createElement("script");sc.src=u;sc.async=true;sc.onload=function(){resolve()};sc.onerror=function(){reject(new Error("Failed to load "+u))};document.head.appendChild(sc)})}var f=(typeof globalThis!=="undefined"?globalThis[name]:undefined);return(f?Promise.resolve():loadScript(url).then(function(){f=globalThis[name]})).then(function(){if(!f)return false;return f().then(function(Module){g(Module);return true})}).catch(function(){return false})}return{randBytes:i,randBase64:e,randHex:v,setProvider:s,setWasmModule:g,getProviderName:o,autoLoadOpenSSLWASM:h}});