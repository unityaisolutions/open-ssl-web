;(function(root,factory){if(typeof module==="object"&&module.exports){module.exports=factory()}else if(typeof define==="function"&&define.amd){define([],factory)}else{root.WebOpenSSL=factory()}})(typeof self!=="undefined"?self:this,function(){"use strict";var p=d();function n(){return typeof process!=="undefined"&&process.versions&&process.versions.node}function a(){try{return typeof require==="function"}catch(e){return false}}function d(){if(n()&&a()){try{var c=require("crypto");return{name:"nodecrypto",randBytes:function(l){var b=c.randomBytes(l);return new Uint8Array(b.buffer,b.byteOffset||0,b.length)}}}catch(e){}}if(typeof globalThis!=="undefined"&&globalThis.crypto&&typeof globalThis.crypto.getRandomValues==="function"){return{name:"webcrypto",randBytes:function(l){if(!Number.isInteger(l)||l<=0)throw new Error("length must be a positive integer");var a=new Uint8Array(l);globalThis.crypto.getRandomValues(a);return a}}}throw new Error("No secure random provider available")}function s(t){if(!t||typeof t.randBytes!=="function")throw new Error("Invalid provider");p=t}function o(){return p&&p.name||"unknown"}function i(l){if(!Number.isInteger(l)||l<=0)throw new Error("length must be a positive integer");return p.randBytes(l)}function u(y){if(typeof Buffer!=="undefined"&&typeof Buffer.from==="function")return Buffer.from(y).toString("base64");var b="",k=32768;for(var i2=0;i2<y.length;i2+=k){b+=String.fromCharCode.apply(null,y.subarray(i2,i2+k))}return btoa(b)}function m(y){var s2="",i2,y2=y.length,h;for(i2=0;i2<y2;i2++){h=y[i2].toString(16);if(h.length<2)h="0"+h;s2+=h}return s2}function e(l){return u(i(l))}function v(l){return m(i(l))}function w(Module){if(!Module||!Module.cwrap||!Module._malloc||!Module._free||!Module.HEAPU8)throw new Error("Invalid OpenSSL WASM Module");var RAND_bytes=Module.cwrap("RAND_bytes","number",["number","number"]);return{name:"openssl-wasm",randBytes:function(length){var ptr=Module._malloc(length);var ret=RAND_bytes(ptr,length);if(ret!==1){Module._free(ptr);throw new Error("RAND_bytes failed")}var out=new Uint8Array(length);out.set(Module.HEAPU8.subarray(ptr,ptr+length));Module._free(ptr);return out}}}function g(Module){s(w(Module))}return{randBytes:i,randBase64:e,randHex:v,setProvider:s,setWasmModule:g,getProviderName:o}});